<Frame x:Class="Profiler.Dialogs.SensibilityEditor"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:local="using:Profiler.Dialogs">
    <Frame.DataContext>
        <d:DesignInstance Type="local:SensibilityEditorModel" IsDesignTimeCreatable="False" />
    </Frame.DataContext>
    <Grid>
        <Grid.Resources>
            <local:DoubleToStringConverter x:Key="f2s" />
            <local:SliderCToDoubleConverter x:Key="s2c" />
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>

        <ToggleSwitch x:Name="chkCurve" OnContent="{StaticResource parametric_curve}" OffContent="{StaticResource custom_curve}" Toggled="ChkCurve_Toggled" HorizontalAlignment="Left" VerticalAlignment="Top"/>
        
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top">
            <TextBlock Text="{StaticResource curve_for_slider}" VerticalAlignment="Center" Margin="5,0"/>
            <ToggleSwitch x:Name="chkSlider" OnContent="" OffContent="" MinWidth="0"/>
        </StackPanel>

        <Grid x:Name="gCustom" Grid.Row="1" Visibility="Visible">
            <Grid.Resources>
                <local:SliderToModelConverter x:Key="s2m" />
                <local:BoolToVisibilityConverter x:Key="b2v" />
                <local:NotBoolToVisibilityConverter x:Key="nb2v" />
            </Grid.Resources>
            <Viewbox Width="880" Height="204" Margin="0,16,0,0" Stretch="Fill" HorizontalAlignment="Left">
                <Path x:Name="DrawUserCurve" StrokeThickness="0.5" Stroke="DarkGreen" />
            </Viewbox>
            <ItemsRepeater ItemsSource="{Binding Columns}">
                <ItemsRepeater.Layout>
                    <UniformGridLayout MinItemWidth="45" Orientation="Horizontal" />
                </ItemsRepeater.Layout>
                <ItemsRepeater.ItemTemplate>
                    <DataTemplate x:DataType="local:SensibilityEditorColumnModel">
                        <StackPanel HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Visibility="{Binding NotLast, Converter={StaticResource b2v}}">
                                <RepeatButton Content="&lt;" FontSize="10" Padding="2,1" Click="BtXl_Click"/>
                                <RepeatButton Content="&gt;" FontSize="10" Padding="2,1" Click="BtXg_Click"/>
                            </StackPanel>
                            <TextBlock Text="{Binding X.Value, Converter={StaticResource f2s}}" HorizontalAlignment="Center" Visibility="{Binding NotLast, Converter={StaticResource b2v}}"/>
                            <TextBlock Text="100" HorizontalAlignment="Center" Foreground="Gray" Margin="0,18,0,0" Visibility="{Binding NotLast, Converter={StaticResource nb2v}}" />
                            <Slider Orientation="Vertical" Value="{Binding Y.Value, Converter={StaticResource s2m}, Mode=TwoWay}" VerticalAlignment="Top" Maximum="200" TickFrequency="20" TickPlacement="Outside" IsThumbToolTipEnabled="False" Height="220" HorizontalAlignment="Center" ValueChanged="Slider_ValueChanged"/>
                            <TextBlock Text="{Binding Y.Value, Converter={StaticResource f2s}}" HorizontalAlignment="Center" />
                        </StackPanel>
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>
        </Grid>

        <Grid x:Name="gParametric" Grid.Row="1" Visibility="Collapsed">
            <Viewbox Grid.Row="1" Width="204" Height="204" Margin="360,16,40,0" Stretch="Fill" HorizontalAlignment="Left">
                <Border Width="204" Height="204" BorderBrush="#a0a0a0" BorderThickness="1,0,0,1" Background="#fafafa">
                    <Path x:Name="DrawParamCurve" StrokeThickness="0.5" Stroke="DarkGreen" Stretch="Fill"/>
                </Border>
            </Viewbox>

            <StackPanel HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,18,0,0" >
                <Grid>
                    <TextBlock Text="0" HorizontalAlignment="Left" Foreground="Gray" />
                    <TextBlock Text="{StaticResource blend}" HorizontalAlignment="Center"  />
                    <TextBlock Text="1" HorizontalAlignment="Right" Foreground="Gray" />
                </Grid>
                <Slider Orientation="Horizontal" Value="{Binding Blend.Value, Converter={StaticResource s2c}, Mode=TwoWay}" VerticalAlignment="Top" Maximum="100" TickFrequency="10" TickPlacement="Outside" IsThumbToolTipEnabled="False" Width="300" HorizontalAlignment="Center" ValueChanged="SliderP_ValueChanged"/>
                <TextBlock Text="{Binding Blend.Value, Converter={StaticResource f2s}, ConverterParameter=2}" HorizontalAlignment="Center" />

                <Grid Margin="0,12,0,0">
                    <Grid.Resources>
                        <x:Double x:Key="min">0.5</x:Double>
                        <x:Double x:Key="max">3.0</x:Double>
                    </Grid.Resources>
                    <TextBlock Text="{StaticResource min}" HorizontalAlignment="Left" Foreground="Gray" />
                    <TextBlock Text="{StaticResource exponent}" HorizontalAlignment="Center"  />
                    <TextBlock Text="{StaticResource max}" HorizontalAlignment="Right" Foreground="Gray" />
                </Grid>
                <Slider Orientation="Horizontal" Value="{Binding Exponent.Value, Converter={StaticResource s2c}, Mode=TwoWay}" VerticalAlignment="Top" Minimum="50" Maximum="300" TickFrequency="5" TickPlacement="Outside" IsThumbToolTipEnabled="False" Width="300" HorizontalAlignment="Center" ValueChanged="SliderP_ValueChanged"/>
                <TextBlock Text="{Binding Exponent.Value, Converter={StaticResource f2s}, ConverterParameter=2}" HorizontalAlignment="Center" />
            </StackPanel>
        </Grid>

        <StackPanel Grid.Row="2" HorizontalAlignment="Left">
            <TextBlock Text="{StaticResource virtual_damping}" Margin="0,12,0,8" FontSize="18" FontWeight="SemiBold"/>
            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                <TextBlock Text="{StaticResource damping_factor}" Width="160" VerticalAlignment="Center" />
                <Slider Value="{Binding DampingK.Value, Converter={StaticResource s2c}, Mode=TwoWay}" Maximum="40" TickFrequency="5" Width="300" IsThumbToolTipEnabled="False" />
            </StackPanel>
            <TextBlock Text="{Binding DampingK.Value, Converter={StaticResource f2s}, ConverterParameter=2}" TextAlignment="Center" Width="300" Margin="120,0,0,0"/>
            <!--<StackPanel Orientation="Horizontal">
                <TextBlock Text="{StaticResource inertia}" Width="160" VerticalAlignment="Center"/>
                <Slider Value="{Binding Inertia.Value, Converter={StaticResource s2c}, Mode=TwoWay}" Maximum="15" TickFrequency="5"  Width="300" IsThumbToolTipEnabled="False"/>
            </StackPanel>
            <TextBlock Text="{Binding Inertia.Value, Converter={StaticResource f2s}, ConverterParameter=2}" TextAlignment="Center" Width="300" Margin="120,0,0,0" />-->
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{StaticResource soft_dead_zone}" Width="160" VerticalAlignment="Center"/>
                <Slider Value="{Binding SoftDeadZone.Value, Mode=TwoWay}" Maximum="20" TickFrequency="5"  Width="300" />
            </StackPanel>
            <TextBlock Text="{Binding SoftDeadZone.Value}" TextAlignment="Center" Width="300" Margin="120,0,0,0" />
        </StackPanel>
    </Grid>
</Frame>
